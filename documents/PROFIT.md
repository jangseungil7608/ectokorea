# 이익계산기 기능계획서 (PROFIT.md)

## 📋 개요

**EctoKorea 이익계산기**는 일본 아마존에서 상품을 구매하여 한국(쿠팡)에서 판매할 때의 수익성을 정확하게 계산하는 핵심 기능입니다.

## 🎯 목적

- 일본 → 한국 수출 비즈니스의 수익성 사전 분석
- 실시간 환율 및 배송료를 반영한 정확한 비용 계산  
- 목표 이익률 기반 추천 판매가 제공
- 카테고리별 세율, 수수료 자동 적용

## 🏗️ 현재 구현 상태

### ✅ 완료된 기능

#### Backend (Laravel)
- **ProfitCalculatorController**: 이익 계산, 추천 가격, 카테고리 정보 API
- **ProfitCalculatorService**: 핵심 계산 로직
- **HaniroShippingService**: 하니로 배송비 계산 및 자동 갱신
- **ExchangeRateService**: 한국수출입은행 환율 API 연동

#### Frontend (Vue 3)
- **ProfitCalculator.vue**: 메인 계산기 컴포넌트
- 실시간 환율 표시 및 갱신
- 반응형 UI 디자인
- 다국어 지원 (한국어/일본어)

#### 배치 처리
- **UpdateHaniroRates Command**: 매일 새벽 4시 하니로 배송료 자동 갱신
- Synology NAS 작업 스케줄러 연동

### 🔧 API Endpoints

#### 이익 계산
- `POST /ectokorea/profit-calculator/calculate`
  - 입력: 상품정보, 무게, 카테고리, 판매가
  - 출력: 상세 비용 분석 및 이익률

#### 추천 판매가
- `POST /ectokorea/profit-calculator/recommend-price`
  - 입력: 상품정보 + 목표 이익률
  - 출력: 추천 판매가 및 실제 이익률

#### 참조 데이터
- `GET /ectokorea/profit-calculator/categories` - 카테고리별 세율/수수료 정보
- `GET /ectokorea/profit-calculator/shipping-options` - 배송 옵션 목록

## 📊 계산 로직 상세

### 1. 일본 측 비용 (JPY)
```
일본 비용 = 상품가격 + 일본 내 배송비 + 국제배송비
```

### 2. 국제배송비 (하니로 기준)
- **Economy**: 월 1-100건, 기본요금 9.00P (P=100엔)
- **Premium**: 월 101-200건, 기본요금 8.50P
- 0.5kg 단위로 1.00P씩 증가 (최대 70kg)
- 매일 새벽 4시 자동 요금 갱신

### 3. 환율 변환
- 한국수출입은행 API 기준 JPY→KRW 환율
- 실시간 조회 및 갱신 기능

### 4. 관세 및 세금 (구매자 부담)
#### 카테고리별 관세율
- **화장품**: 8%
- **의류/패션**: 13%  
- **전자제품**: 8%
- **식품**: 30% (수입제한 주의)
- **도서**: 0%
- **기타**: 8%

#### 면세 기준
- $150 이하 (약 20만원) 개인용품 면세
- 관세 + 부가세(10%) 자동 계산

### 5. 한국 내 비용 (KRW)
```
한국 비용 = 국내배송비 + 포장비 + 기타비용
```

### 6. 플랫폼 수수료 (쿠팡 기준)
#### 카테고리별 수수료율
- **화장품**: 15%
- **의류**: 12%
- **전자제품**: 10%
- **식품**: 18%
- **도서**: 10%
- **일반**: 12%

#### 추가 수수료
- **결제수수료**: 3%
- **총 플랫폼 수수료** = 쿠팡 수수료 + 결제수수료

### 7. 최종 이익 계산
```
순이익 = 판매가 - 총비용 - 플랫폼수수료
이익률 = (순이익 ÷ 판매가) × 100
```

### 8. 추천 판매가 계산
```
추천가격 = 총비용 ÷ (1 - 목표이익률 - 플랫폼수수료율)
```

## 🎨 사용자 인터페이스

### 입력 폼 구성
1. **일본 상품 정보**
   - 상품가격 (JPY) *필수
   - 일본 내 배송비 (JPY)
   - 상품 무게 (g) *필수
   - 배송방법 (Economy/Premium)
   - 상품 카테고리

2. **한국 판매 정보**
   - 판매예정가 (KRW) *필수
   - 국내배송비 (KRW)
   - 포장비 (KRW)

### 계산 결과 표시
- 📊 **비용 분석**: 단계별 비용 내역
- 💰 **이익 정보**: 순이익, 이익률
- 🎯 **추천가격**: 목표 이익률 기반
- 📈 **실시간 환율**: 현재 JPY/KRW 환율

## 🔄 실시간 업데이트

### 환율 정보
- 한국수출입은행 API 연동
- 수동 갱신 버튼 제공
- 최종 업데이트 시간 표시

### 배송료 정보  
- 하니로 웹사이트 스크래핑
- 매일 새벽 4시 자동 갱신
- Synology NAS 작업 스케줄러 연동

## 🧪 테스트 및 디버깅

### 디버그 API
- `POST /ectokorea/profit-calculator/debug-recommend-price`
  - 단계별 계산 과정 상세 출력
  - 테스트 데이터 기본 제공

### 배송비 테스트
- `GET /ectokorea/profit-calculator/debug-shipping`
  - 1kg 기준 배송비 계산 과정 확인

## 📱 반응형 디자인

### 데스크톱
- 2컬럼 레이아웃
- 실시간 계산 결과 표시
- 상세 비용 분석표

### 모바일
- 1컬럼 적응형 레이아웃  
- 터치 최적화 인터페이스
- 간소화된 정보 표시

## 🌐 다국어 지원

### 지원 언어
- **한국어** (기본)
- **일본어** (예정)

### 번역 범위
- UI 레이블 및 메시지
- 카테고리명
- 오류 메시지
- 도움말 텍스트

## 🔮 향후 개발 계획

### Phase 2: 고도화
- [ ] **상품 즐겨찾기**: 자주 계산하는 상품 저장
- [ ] **계산 히스토리**: 과거 계산 결과 이력 관리
- [ ] **일괄 계산**: CSV 업로드를 통한 대량 계산
- [ ] **수익성 분석**: 월별/카테고리별 통계

### Phase 3: 확장 기능
- [ ] **다른 배송업체 지원**: DHL, EMS, SAL 등
- [ ] **다른 플랫폼 지원**: 11번가, 지마켓, 옥션 등  
- [ ] **자동 가격 모니터링**: 경쟁 상품 가격 추적
- [ ] **시장성 분석**: 카테고리별 트렌드 분석

### Phase 4: AI/ML 통합
- [ ] **가격 예측**: 과거 데이터 기반 최적 가격 제안
- [ ] **수요 예측**: 계절성/트렌드 고려한 수요 예측
- [ ] **리스크 분석**: 환율 변동, 정책 변화 영향 분석

## 🔧 기술 스택

### Backend
- **Laravel 12** (PHP 8.2+)
- **PostgreSQL** (데이터베이스)
- **Symfony DomCrawler** (웹 스크래핑)
- **Guzzle HTTP** (API 클라이언트)

### Frontend  
- **Vue 3** (Composition API)
- **Vite** (빌드 도구)
- **Tailwind CSS** (스타일링)
- **Axios** (HTTP 클라이언트)

### Infrastructure
- **Docker** (컨테이너화)
- **Synology NAS** (호스팅)
- **작업 스케줄러** (배치 처리)

## 📊 성능 지표

### 목표 성능
- **응답시간**: < 2초 (계산 API)
- **가용성**: 99.5% (월간 기준)
- **동시 사용자**: 50명 (피크 타임)

### 모니터링
- Laravel 로그 (storage/logs/)
- API 응답시간 추적
- 배치 작업 성공률

## 🛡️ 보안 고려사항

### 데이터 보호
- 개인정보 최소 수집
- 계산 결과 임시 저장만
- HTTPS 필수 (외부 접속)

### API 보안
- CORS 설정 (허용된 도메인만)
- 입력값 검증 및 Sanitization
- Rate Limiting (예정)

---

## 📞 지원 및 문의

- **개발자**: EctoKorea 개발팀
- **업데이트**: 매월 둘째 주 목요일
- **문의**: GitHub Issues 또는 Discord

*최종 업데이트: 2025-08-14*